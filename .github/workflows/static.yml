# Simple workflow for deploying static content to GitHub Pages
name: Deploy static content to Pages

on:
  # Runs on pushes targeting the default branch
  push:
    branches: ["main"]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  # Single deploy job since we're just deploying
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        # 使用的操作 actions，可以使用公共仓库，本地仓库，别人的仓库的action
        # 拉取代码
        uses: actions/checkout@v2
        with:
            persist-credentials: false
      - name: Build
        run: npm install && npm run docs:build
        
      - name: Deploy
        # 构建发布 Github pages
        uses: zh3389/colorfu@gh-pages
        # 该步骤所需的环境变量
        with:
            ACCESS_TOKEN: ${{ secrets.ACTION_TOKEN }}
            # 在部署前要checkout的基本分支，默认是main
            BASE_BRANCH: master # The branch the action should deploy from.
            # 指定部署的分支，默认是 gh-pages 分支
            BRANCH: gh-pages # The branch the action should deploy to.
            # 存储库中要部署的文件夹。
            # 该步骤会将项目中 FOLDER 指定文件夹下的文件推送到 BRANCH 分支，作为Github Pages 部署的内容。
            # Vue CLI默认打包到 dist 目录
            FOLDER: dist # The folder the action should deploy.
            
            
